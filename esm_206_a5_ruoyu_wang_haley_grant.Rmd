---
title: "ESM 206 Assignment 5"
author: "Ruoyu Wang & Haley Grant"
date: "11/22/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE)

library(tidyverse)
library(janitor)
library(ggbeeswarm)
library(car)
library(kableExtra)
library(janitor)
library(broom)
library(ggpubr)
library(DT)
```

#### Introduction

#### Data and Methods

#### Results

##### Results A

Visually compare annual salamander counts in old growth (OG) and clear cut (CC) sections of Mack Creek. 

```{r}

# Read in data

mack_creek_df <- read_csv("mack_creek_vertebrates.csv") %>% 
  clean_names()

```

```{r} 

# Data wrangling

mack_creek_a <- mack_creek_df %>% 
  filter(year > 1992) %>%
  filter(species == "DITE") %>% 
  group_by(year, section) %>% 
  summarize(total_count <- sum(!is.na(species))) %>% 
  rename(total_count = "total_count <- sum(!is.na(species))")

```

```{r}

# Create a finalized graph

ggplot(mack_creek_a, aes(x = year, y = total_count, color = section)) +
  geom_point(size = 0.8) +
  geom_smooth(method = "lm",
              size = 0.8,
              alpha = 0.3) +
  theme_light() +
  labs(title = "Annual salamander counts in old growth vs. clear cut sections of Mack Creek",
       x = "Year",
       y = "Total Count")
```

##### Results B

Table of 2017 salamander counts by channel classification (pool, cascades and side-channel) in old growth (OG) and clear cut (CC) sections of Mack Creek.

```{r}
# Data wrangling

mack_creek_b <- mack_creek_df %>% 
  filter(year == 2017) %>% 
  filter(species == "DITE") %>% 
  filter(unittype %in% c("C", "SC", "P")) %>% 
  select("year", "section", "unittype", "species") %>% 
  group_by(year, section, unittype) %>% 
  summarise(count = sum(!is.na(species))) %>%
  group_by(year) %>% 
  mutate(proportion = count/sum(count))
```

```{r}
# Make a table

mack_creek_b %>% 
  kable(col.names = c("Year",
  "Section", 
                     "Channel",
                     "Count",
                     "Proportion")) %>% 
  kable_styling(bootstrap_options = "striped", 
                full_width = F,
                position = "left"
                ) %>% 
  add_header_above(c("Salamander counts by channel classification" = 5))
```

##### Results C

Is there a significant difference in where in the channel Pacific giant salamanders are located (pool, cascade or side channel) between the two sections (old growth and clear cut)? 

Answer: The majority of Salamanders in 2017 were found in cascades in clear cut sections of the forrest. The next place Salamanders were found the most was in cascades in old growth forests. It appears that salamanders prefer cascades to other location types. 

##### Results D

Only considering creek section (OG or CC) as a variable (not further factoring by channel classification), answer: Is there a significant difference in mean weights for Pacific giant salamanders observed in the two forest sections (CC and OG) in 2017?

--> Is there a significant difference in mean weights for salamanders observed in CC and OG sections in 2017?

```{r}

# Specify the data to be tested

mack_creek_d <- mack_creek_df %>%
  filter(year == 2017) %>% 
  filter(species == "DITE") %>% 
  select(year, section, species, weight) %>% 
  group_by(section) %>% 
  summarise(mean_weight = mean(weight, na.rm = TRUE))

```

```{r}

# Perform a t.test
# null hypothesis: means are equal (difference in means = 0)
# alternative hypothesis: means are not equal

t_test_result_d <- t.test(mack_creek_d$mean_weight)

```

The p-value equals `r t_test_result_d$p.value`, which is just barely over our alpha value of .05. This could mean that it's possible these samples are from the same populaiton, but it's relatively unlikely. The salamanders in question we know are from the same population, given that they are all salamanders in Mack Creek, however, they are differentiated by their location in Mack Creek. The salamanders found in Clear Cut sections of the forest had a mean weight of `r mack_creek_d$mean_weight`, while Old Growth sections had a mean weight of `r mack_creek_d$mean_weight`. 

The mean weight for salamanders in Clear Cut sections was greater than the mean weight of salamanders in Old Growth sections, even though the salamanders are technically from the same population.
 
##### Results E

Compare weights of Pacific giant salamanders in pools, cascades and side-channels of Mack Creek in 2017. 

```{r}

# you will not consider "section" as a factor here

mack_creek_e <- mack_creek_df %>%
  filter(year == 2017) %>% 
  filter(species == "DITE") %>% 
  select(year, species, weight, unittype) %>% 
  group_by(unittype) %>% 
  summarise(mean_weight_unittype = mean(weight, na.rm = TRUE))

```

- First, visually compare Pacific giant salamander weights between the three channel classifications. 

```{r}

# make a graph



```


- 
- 

#### Summary

#### References 

Gregory S. V. 2016. Aquatic Vertebrate Population Study in Mack Creek, Andrews Experimental Forest, 1987 to present. Environmental Data Initiative. https://doi.org/10.6073/pasta/5de64af9c11579266ef20da2ff32f702.








